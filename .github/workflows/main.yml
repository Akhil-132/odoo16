name: Odoo 16 Installation

on:
  push:
    branches:
      - master

jobs:
  install-odoo:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v2

    - name: Set up Python 3.7
      uses: actions/setup-python@v2
      with:
        python-version: 3.7

    - name: Install PostgreSQL
      run: |
        sudo apt-get update
        sudo apt-get install postgresql
      continue-on-error: true

    - name: Create Odoo User
      run: |
        sudo su - postgres -c "createuser --createdb --odoo postgres --no-createrole --no-superuser odoo16"
      continue-on-error: true

    - name: Install Dependencies
      run: |
        sudo apt-get install python3-pip
        pip3 install -r requirements.txt
      working-directory: ./odoo16  # Replace with the path to your Odoo repository

    - name: Initialize Odoo Database
      run: |
        ./odoo-bin -c debian/odoo.conf -d odoo --without-demo all
      working-directory: ./odoo16 

    - name: Start Odoo Service
      run: |
        sudo service odoo16 start
      continue-on-error: true
